<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>WordBomb Helper – Générateur de mots</title>
<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: Arial, sans-serif;
  background: #0b0f14;
  color: #e6edf3;
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: 220px;
  background: #070b10;
  border-right: 1px solid #111;
  display: flex;
  flex-direction: column;
  padding-top: 20px;
}

.sidebar h2 {
  color: #7bc8ff;
  text-align: center;
  margin-bottom: 20px;
}

.sidebar a {
  text-decoration: none;
  color: #e6edf3;
  padding: 12px 20px;
  margin: 5px;
  border-radius: 10px;
  transition: 0.2s;
  background: #13374a;
  text-align: center;
  font-weight: bold;
}

.sidebar a:hover {
  background: #18506a;
  transform: translateY(-2px);
}

.main {
  flex: 1;
  padding: 40px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

header {
  background: #070b10;
  padding: 24px;
  text-align: center;
  border-bottom: 1px solid #111;
  width: 100%;
  margin-bottom: 20px;
}

header h1 {
  font-size: 28px;
  color: #7bc8ff;
  margin: 0;
}

.container {
  max-width: 900px;
  width: 100%;
  padding: 20px;
}

label {
  display: block;
  margin-top: 15px;
  margin-bottom: 5px;
}

input, button, textarea {
  width: 100%;
  margin: 5px 0;
  padding: 8px;
  border-radius: 5px;
  border: none;
  font-size: 14px;
  background: #1E1E1E;
  color: #E0E0E0;
}

input[type="file"] {
  padding: 3px;
}

textarea {
  font-family: monospace;
  height: 200px;
}

button {
  background-color: #18506a;
  color: white;
  cursor: pointer;
  transition: 0.2s;
  border-radius: 12px;
  padding: 10px;
  font-weight: bold;
  margin-top: 10px;
}

button:hover {
  background-color: #1e6f8e;
}

h2, h3 {
  color: #7bc8ff;
  margin-top: 20px;
  text-align: center;
}

ul {
  margin-top: 15px;
  padding-left: 20px;
  list-style: none;
}

li {
  margin-bottom: 5px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #13374a;
  padding: 8px 12px;
  border-radius: 10px;
  box-shadow: 0 0 10px #0005;
}

.valider {
  cursor: pointer;
  color: #4CAF50;
  font-weight: bold;
}

.valider:hover {
  color: #81C784;
}

footer {
  margin-top: 50px;
  text-align: center;
  font-size: 14px;
  opacity: 0.5;
  padding-bottom: 20px;
}
</style>
</head>
<body>

<div class="sidebar">
  <h2>Menu</h2>
  <a href="index.html">Accueil</a>
  <a href="grille.html">Grille</a>
  <a href="sub1.html">SUB1</a>
  <a href="all.html">All</a>
  <a href="json.html">JSON</a>
  <a href="helper.html">Helper</a>
  <a href="dictionnaire.html">Dictionnaires</a>
  <a href="kitty.html">Kitty.</a>
</div>

<div class="main">
  <header>
    <h1>Générateur de mots avec syllabes</h1>
  </header>

  <div class="container">
    <label>JSON des syllabes :</label>
    <textarea id="syllabesJson">
{
  "E": 32,
  "YA": 1,
  "A": 19,
  "O": 17,
  "S": 30,
  "N": 16,
  "I": 22,
  "U": 13,
  "PH": 1,
  "Y": 1,
  "AX": 1,
  "D": 7,
  "FA": 1,
  "C": 10,
  "NI": 1,
  "IQU": 1,
  "M": 8,
  "F": 6,
  "HI": 1,
  "ND": 1,
  "R": 10,
  "B": 6,
  "T": 7,
  "P": 3,
  "L": 10,
  "H": 3,
  "Q": 2,
  "X": 4,
  "J": 1,
  "G": 3,
  "Z": 2,
  "K": 1,
  "V": 2,
  "-": 3,
  "-NU": 1,
  "MI": 1,
  "PI": 1,
  "TR": 1
}
    </textarea>

    <label>Syllabe obligatoire :</label>
    <input type="text" id="syllabe" maxlength="4" placeholder="Ex: T">

    <label>Taille max du mot :</label>
    <input type="number" id="tailleMax" min="1" placeholder="Ex: 24">

    <label>Position de la syllabe :</label>
    <input type="number" id="position" min="1" placeholder="Ex: 4">

    <label>Fichier de mots (.txt) :</label>
    <input type="file" id="fichier">

    <button onclick="genererMots()">Générer</button>

    <h3>Résultats :</h3>
    <ul id="resultats"></ul>
  </div>

  <footer>
    BILLIE LA REINE DE CE MONDE.
  </footer>
</div>

<script>
let motsResultats = [];

function genererMots() {
    const fileInput = document.getElementById('fichier');
    if (!fileInput.files[0]) {
        alert("Veuillez uploader un fichier de mots.");
        return;
    }

    let syllabesJson;
    try {
        syllabesJson = JSON.parse(document.getElementById('syllabesJson').value);
    } catch(e) {
        alert("JSON invalide !");
        return;
    }

    let syllabes = Object.keys(syllabesJson).sort((a,b)=>b.length-a.length);

    const syllabeObligatoire = document.getElementById('syllabe').value.toUpperCase();
    const tailleMax = parseInt(document.getElementById('tailleMax').value);
    const position = parseInt(document.getElementById('position').value) - 1;

    const reader = new FileReader();
    reader.onload = function(e) {
        const contenu = e.target.result;
        const motsFichier = contenu.split(/\r?\n/).map(w => w.trim().toUpperCase()).filter(w => w);

        motsResultats = [];

        for (let mot of motsFichier) {
            if (mot.length > tailleMax) continue;
            if (position + syllabeObligatoire.length > mot.length) continue;
            if (mot.substr(position, syllabeObligatoire.length) !== syllabeObligatoire) continue;

            let reste = mot;
            let utilisé = [];
            let valide = true;
            let stockTemp = {...syllabesJson};

            while (reste.length > 0) {
                let trouvé = false;
                for (let s of syllabes) {
                    if (reste.startsWith(s)) {
                        if (!(reste.substr(0, syllabeObligatoire.length) === syllabeObligatoire && utilisé.join('').length === position)) {
                            if (s === '-' || (stockTemp[s] && stockTemp[s] > 0)) {
                                utilisé.push(s);
                                if (s !== '-') stockTemp[s]--;
                            } else {
                                continue;
                            }
                        }
                        reste = reste.slice(s.length);
                        trouvé = true;
                        break;
                    }
                }
                if (!trouvé) {
                    valide = false;
                    break;
                }
            }

            if (valide) {
                motsResultats.push({mot: mot, syllabes: utilisé});
            }
        }

        motsResultats.sort((a,b)=>b.mot.length - a.mot.length);
        afficherResultats();
    }

    reader.readAsText(fileInput.files[0]);
}

function afficherResultats() {
    const ul = document.getElementById('resultats');
    ul.innerHTML = "";

    if(motsResultats.length === 0){
        ul.innerHTML = "<li>Aucun mot trouvé</li>";
    } else {
        for (let i = 0; i < motsResultats.length; i++) {
            const r = motsResultats[i];
            const li = document.createElement('li');
            li.innerHTML = `<span>${r.mot} => [${r.syllabes.join(', ')}]</span> <span class="valider" onclick='validerMot(${i})'>✔</span>`;
            ul.appendChild(li);
        }
    }
}

function validerMot(index) {
    const motInfo = motsResultats[index];
    if (!motInfo) return;

    let jsonTextarea = document.getElementById('syllabesJson');
    let json;
    try {
        json = JSON.parse(jsonTextarea.value);
    } catch(e) {
        alert("JSON invalide !");
        return;
    }

    motInfo.syllabes.forEach(s => {
        if (s !== '-' && json[s]) {
            json[s]--;
            if (json[s] <= 0) delete json[s];
        }
    });

    jsonTextarea.value = JSON.stringify(json, null, 2);
    alert("Syllabes retirées du JSON !");
}
</script>

</body>
</html>


